#!/bin/bash

# Extraigo el directorio donde se encuentra el Pom
pom_directory=$(dirname "$(locate pom.xml | xargs grep -l "<struts2.version>" | head -n 1)")

if [ -z "$pom_directory" ]; then
    echo "No se encontró el directorio del archivo pom.xml con la versión de Struts."
    exit 1
fi

# Se actualiza la versión de Struts en el archivo pom.xml
sed -i 's/<struts2.version>.*<\/struts2.version>/<struts2.version>6.3.0.2<\/struts2.version>/' "$pom_directory/pom.xml"

cd "$pom_directory" || exit 1

# Vuelvo a hacer build sobre el modulo de mvn que contiene a struts
mvn -e clean package -Dmaven.test.skip=true -pl file-upload

echo "La versión de Apache Struts ha sido actualizada y el módulo fue reconstruido correctamente."